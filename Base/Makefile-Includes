#
# This file is part of the amigus.library.
#
# amigus.library is free software: you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3 of the License only.
#
# amigus.library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
# See the GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with amigus.library.
#
# If not, see <http://www.gnu.org/licenses/>.
#

BASE    		= amigus
PATH    		= include
AMIGUS_INCLUDES = include-src

#CAMD_ORIG_CLIB   = $(CAMD_INCLUDES)/include/clib/$(BASE)_protos.h
#CAMD_ORIG_FD     = $(CAMD_INCLUDES)/fd/$(BASE)_lib.fd

#AMIGUS_SFD    = RAM:$(BASE)_lib.fd

AMIGUS_SFD        = $(AMIGUS_INCLUDES)/sfd/$(BASE)_lib.sfd

default: all

#$(AMIGUS_SFD): $(CAMD_ORIG_FD)
#	edit FROM $< TO $@ WITH fd_patch

#SFDPATH = $(PATH)/sfd/
#SFDNAME = $(SFDPATH)$(BASE).sfd
#$(SFDNAME): $(AMIGUS_SFD)
#	-@makedir $(SFDPATH) ALL >NIL:
#	fd2pragma SPECIAL 112 INFILE $(AMIGUS_SFD) TO $(SFDPATH)

PRAGMAPATH = $(PATH)/C/pragma/
PRAGMANAME = $(PRAGMAPATH)$(BASE)_lib.h
$(PRAGMANAME): $(AMIGUS_SFD)
	-@makedir $(PRAGMAPATH) ALL >NIL:
	fd2pragma SPECIAL   6 INFILE $(AMIGUS_SFD) TO $(PRAGMAPATH)

AMIGAEPATH = $(PATH)/AmigaE/
AMIGAENAME = $(AMIGAEPATH)$(BASE).m
$(AMIGAENAME): $(AMIGUS_SFD)
	-@makedir $(AMIGAEPATH) ALL >NIL:
	fd2pragma SPECIAL  18 INFILE $(AMIGUS_SFD) TO $(AMIGAEPATH)

GCCINLINEPATH = $(PATH)/C/inline/
GCCINLINENAME = $(GCCINLINEPATH)$(BASE).h
$(GCCINLINENAME): $(AMIGUS_SFD)
	-@makedir $(GCCINLINEPATH) ALL >NIL:
	fd2pragma SPECIAL  40 INFILE $(AMIGUS_SFD) TO $(GCCINLINEPATH)

PROTOPATH = $(PATH)/C/proto/
PROTONAME = $(PROTOPATH)$(BASE).h
$(PROTONAME): $(AMIGUS_SFD)
	-@makedir $(PROTOPATH) ALL >NIL:
	fd2pragma SPECIAL  38 INFILE $(AMIGUS_SFD) TO $(PROTOPATH)

VBCCINLINEPATH = $(PATH)/C/inline/
VBCCINLINENAME = $(VBCCINLINEPATH)$(BASE)_protos.h
$(VBCCINLINENAME): $(AMIGUS_SFD)
	-@makedir $(VBCCINLINEPATH) ALL >NIL:
	fd2pragma SPECIAL  70 INFILE $(AMIGUS_SFD) TO $(VBCCINLINEPATH)

LVOPATH = $(PATH)/ASM/lvo/
LVONAME = $(LVOPATH)$(BASE)_lib.i
$(LVONAME): $(AMIGUS_SFD)
	-@makedir $(LVOPATH) ALL >NIL:
	fd2pragma SPECIAL  23 INFILE $(AMIGUS_SFD) TO $(LVOPATH)

FDPATH = $(PATH)/FD/
FDNAME = $(FDPATH)$(BASE)_lib.fd
$(FDNAME): $(AMIGUS_SFD)
	-@makedir $(FDPATH) ALL >NIL:
	fd2pragma SPECIAL 110 INFILE $(AMIGUS_SFD) TO $(FDPATH) COMMENT

CLIBPATH = $(PATH)/C/clib/
CLIBNAME = $(CLIBPATH)$(BASE)_protos.h
$(CLIBNAME): $(AMIGUS_SFD)
	-@makedir $(CLIBPATH) ALL >NIL:
	fd2pragma SPECIAL 111 INFILE $(AMIGUS_SFD) TO $(CLIBPATH) COMMENT
# breaks it sometimes... COPYRIGHT $(AUTHOR)

all: $(PRAGMANAME) $(AMIGAENAME) $(GCCINLINENAME) $(PROTONAME) \
     $(VBCCINLINENAME) $(LVONAME) $(FDNAME) $(CLIBNAME) \
     $(LIBRARYNAME) $(SFDNAME)
	-@makedir $(PATH)/C/amigus ALL >NIL:
	copy $(AMIGUS_INCLUDES)/amigus/#?.h $(PATH)/C/amigus/ ALL CLONE
	copy $(AMIGUS_INCLUDES)/amigus/#?.i $(PATH)/C/amigus/ ALL CLONE

clean:
	-@delete $(PATH)/~((sfd)|(amigus)) ALL

# Prepare doing:
# cp Makefile-Includes ~/Documents/FS-UAE/Shared/Projekte/AmiGUS/
# cp -R  include-src ~/Documents/FS-UAE/Shared/Projekte/AmiGUS/
# cp fd2pragma.types ~/Documents/FS-UAE/Shared/Projekte/AmiGUS
#
# Use result:
# cp -R ~/Dokumente/FS-UAE/Shared/Projekte/AmiGUS/include .
# for UAEM in `find include | grep \.uaem` ; do rm $UAEM ; done
